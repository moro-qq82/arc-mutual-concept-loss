{
  "ablation": "B5",
  "variant": "single_head",
  "description": "単一ヘッドかつ中間次元を縮小した疑似GRUスタイル表現の効果を調べる。",
  "stage": "train",
  "base_config": "configs/train.yaml",
  "seed": 20250214,
  "data": {
    "processed_dir": "data/processed",
    "splits_dir": "data/splits",
    "batch_size": 4
  },
  "model_kwargs": {
    "context_layers": 3,
    "context_heads": 1,
    "context_model_dim": 192,
    "dropout": 0.15
  },
  "loss": {
    "task_loss_type": "cross_entropy",
    "task_ignore_index": -100,
    "task_label_smoothing": 0.0,
    "task_exact_match_weight": 0.1,
    "sae_recon_weight": 1.0,
    "sae_l1_weight": 0.001,
    "sae_target_sparsity": 0.05,
    "sae_adaptation_rate": 5.0,
    "sae_activation_threshold": 0.001,
    "share_rank": 8,
    "share_activation_threshold": 0.001,
    "share_min_group_size": 4,
    "alpha": 1.0,
    "beta": 1.0
  },
  "optimizer": {
    "lr": 0.0003,
    "weight_decay": 0.01,
    "betas": [
      0.9,
      0.95
    ]
  },
  "scheduler": {
    "warmup_steps": 0,
    "warmup_ratio": 0.1,
    "min_lr_ratio": 0.1
  },
  "trainer": {
    "epochs": 50,
    "gradient_accumulation_steps": 1,
    "max_grad_norm": 1.0,
    "use_amp": true,
    "amp_dtype": "bf16",
    "log_interval": 25,
    "eval_interval": 1,
    "checkpoint_dir": "checkpoints/ablations/B5_single_head",
    "tensorboard_dir": "logs/train/ablations/B5_single_head/tensorboard",
    "history_path": "logs/train/ablations/B5_single_head/history.jsonl",
    "device": null
  },
  "metrics": {
    "validation": {
      "total_loss": 1.2380158376693726,
      "task_loss": 1.2378335571289063,
      "sae_loss": 0.000182279699947685,
      "share_loss": 0.0,
      "pixel_accuracy": 0.7389716386795044,
      "exact_match_rate": 0.02,
      "exact_match_loss": 0.98,
      "sae_reconstruction_loss": 1.8925539989140817e-05,
      "sae_l1_loss": 0.06438593447208404,
      "sae_l1_weight": 0.002537109423428774,
      "sae_sparsity": 0.357421875,
      "share_share_loss": 0.0,
      "share_share_groups": 0.0
    }
  }
}